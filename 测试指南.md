# 🧪 测试指南

## 快速测试修复功能

### 前置条件

1. ✅ 服务器正在运行
   ```bash
   cd /workspace/projects
   python src/server.py
   ```

2. ✅ 获取服务器局域网IP
   ```bash
   # Linux
   ip addr show | grep "inet "
   
   # macOS
   ifconfig | grep "inet "
   
   # Windows
   ipconfig
   ```
   
   记下IPv4地址，例如：`192.168.1.100`

3. ✅ 手机和服务器在同一WiFi网络

4. ✅ 重新构建并安装APK

---

## 测试步骤

### 测试1：配置服务器地址 ✅

**步骤：**
1. 启动应用
2. 点击底部导航的"设置" ⚙️
3. 在"API地址"输入框输入：`http://你的IP:8000/api`
   - 例如：`http://192.168.1.100:8000/api`
4. 点击"🔍 测试连接"
5. 应该显示"✅ 连接成功！"
6. 点击"💾 保存配置"

**预期结果：**
- ✅ 测试连接成功
- ✅ 配置已保存
- ✅ 应用能正常加载数据

---

### 测试2：新增卡牌（从图库选择图片） 📷

**步骤：**
1. 点击"✨ 新增卡牌人物"
2. 填写必要信息：
   - 姓名：张三
   - 年龄：25
   - 性别：男
   - 职业：工程师
3. 点击"📷 从图库选择"
4. 选择一张图片
5. 查看图片预览是否正常显示
6. 点击"💾 保存卡牌"

**预期结果：**
- ✅ 能正常选择图片
- ✅ 图片预览正常显示
- ✅ 保存成功，显示"✨ 卡牌创建成功"
- ✅ 卡牌列表中显示新卡牌
- ✅ 卡牌头像显示选择的图片

---

### 测试3：新增卡牌（拍照） 📸

**步骤：**
1. 点击"✨ 新增卡牌人物"
2. 填写必要信息：
   - 姓名：李四
   - 年龄：30
   - 性别：女
   - 职业：设计师
3. 点击"📸 拍照"
4. 拍摄一张照片
5. 查看图片预览是否正常显示
6. 点击"💾 保存卡牌"

**预期结果：**
- ✅ 能正常启动相机
- ✅ 能正常拍照
- ✅ 图片预览正常显示
- ✅ 保存成功，显示"✨ 卡牌创建成功"
- ✅ 卡牌列表中显示新卡牌
- ✅ 卡牌头像显示拍摄的照片

---

### 测试4：新增卡牌（输入图片链接） 🔗

**步骤：**
1. 点击"✨ 新增卡牌人物"
2. 填写必要信息：
   - 姓名：王五
   - 年龄：28
   - 性别：男
3. 在"输入图片链接"输入框输入：
   - 例如：`https://via.placeholder.com/150`
4. 点击"💾 保存卡牌"

**预期结果：**
- ✅ 保存成功
- ✅ 卡牌列表中显示新卡牌
- ✅ 卡牌头像显示链接图片

---

### 测试5：编辑卡牌 ✏️

**步骤：**
1. 点击已创建的卡牌（例如"张三"）
2. 点击"✏️ 编辑"
3. 修改信息：
   - 姓名：张三（修改版）
   - 职业：高级工程师
4. 可选：更换图片
5. 点击"💾 保存卡牌"

**预期结果：**
- ✅ 能正常打开编辑界面
- ✅ 显示原有信息
- ✅ 显示原有图片
- ✅ 修改成功，显示"✅ 卡牌更新成功"
- ✅ 卡牌信息已更新
- ✅ 卡牌详情页面显示更新后的信息

---

### 测试6：记录互动 💬

**步骤：**
1. 点击一个卡牌
2. 点击"📝 记录互动"
3. 输入互动内容：
   - 例如：今天和同事一起吃了午餐，聊了很多工作上的事情
4. 点击"✅ 保存互动"

**预期结果：**
- ✅ 能正常打开互动记录界面
- ✅ 保存成功，显示"✅ 互动记录添加成功"
- ✅ 卡牌详情页面显示互动记录
- ✅ 互动时间和内容正确显示

---

### 测试7：生成策略报告 🎯

**步骤：**
1. 点击一个有互动记录的卡牌
2. 点击"🎯 策略报告"
3. 等待生成完成（可能需要几秒钟）

**预期结果：**
- ✅ 显示"🎯 正在生成策略报告，请稍候..."
- ✅ 生成成功，显示"✨ 策略报告生成成功"
- ✅ 显示"社交策略报告"部分
- ✅ 包含"当前评价"和"今后策略"

---

### 测试8：删除卡牌 🗑️

**步骤：**
1. 点击一个卡牌
2. 点击"🗑️ 删除"
3. 确认删除

**预期结果：**
- ✅ 显示确认对话框
- ✅ 删除成功，显示"✅ 卡牌删除成功"
- ✅ 卡牌列表中不再显示该卡牌

---

### 测试9：搜索功能 🔍

**步骤：**
1. 在搜索框输入关键词
2. 例如：输入"张"

**预期结果：**
- ✅ 能正常搜索
- ✅ 显示匹配的卡牌
- ✅ 搜索结果正确

---

### 测试10：设置功能 ⚙️

**步骤：**
1. 点击"设置"
2. 修改API地址（例如，改成一个错误的地址）
3. 点击"测试连接"
4. 应该显示连接失败
5. 改回正确的地址
6. 点击"测试连接"
7. 应该显示连接成功
8. 点击"保存配置"

**预期结果：**
- ✅ 错误地址测试连接失败
- ✅ 正确地址测试连接成功
- ✅ 配置能正常保存和加载

---

## 测试清单

| 测试项 | 状态 | 备注 |
|--------|------|------|
| 配置服务器地址 | ⬜ | |
| 新增卡牌（图库） | ⬜ | |
| 新增卡牌（拍照） | ⬜ | |
| 新增卡牌（链接） | ⬜ | |
| 编辑卡牌 | ⬜ | |
| 记录互动 | ⬜ | |
| 生成策略报告 | ⬜ | |
| 删除卡牌 | ⬜ | |
| 搜索功能 | ⬜ | |
| 设置功能 | ⬜ | |

---

## 常见问题排查

### 问题1：测试连接失败

**可能原因：**
1. 服务器未运行
2. IP地址错误
3. 防火墙阻止连接
4. 手机和服务器不在同一网络

**解决方案：**
```bash
# 1. 检查服务器是否运行
ps aux | grep server.py

# 2. 检查端口是否监听
netstat -tlnp | grep 8000

# 3. 测试服务器是否可访问
curl http://localhost:8000/

# 4. 检查防火墙
sudo ufw status
sudo ufw allow 8000
```

### 问题2：图片选择失败

**可能原因：**
1. 未授予相机/相册权限
2. 插件未正确安装
3. APK版本不匹配

**解决方案：**
1. 检查应用权限设置
2. 确认使用最新版本APK
3. 重新构建APK

### 问题3：保存卡牌失败

**可能原因：**
1. API地址配置错误
2. 服务器端错误
3. 数据库连接问题

**解决方案：**
1. 检查设置中的API地址
2. 查看服务器日志
3. 测试数据库连接

---

## 测试完成后的操作

如果所有测试都通过：

1. ✅ 功能正常，可以使用
2. ✅ 提交测试报告（如有需要）
3. ✅ 准备发布

如果有测试失败：

1. ❌ 记录失败步骤
2. ❌ 查看错误日志
3. ❌ 分析原因
4. ❌ 修复问题
5. ❌ 重新测试

---

## 反馈

如果在测试过程中发现任何问题，请记录：
1. 具体操作步骤
2. 预期结果
3. 实际结果
4. 错误信息
5. 设备信息（手机型号、Android版本等）

**祝你测试顺利！** 🧪✨
